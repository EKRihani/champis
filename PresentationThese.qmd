---
title: "Application de modèles d'apprentissage machine à la classification des macromycètes"
author: "Emir Kaïs RIHANI"
format:
  revealjs:
    #theme: litera
    theme: solarized
    slide-number: true
    embed-resources: true
---

```{r setup, include = FALSE, warning = FALSE}
load("EKR-Champis-Valeurs.RData")      # Chargement des valeurs diverses utilisées/calculées dans la thèse
load("EKR-Champis-Iris-Light.RData")  # Chargement des exemples Iris
load("EKR-Champis-Intro-Light.RData")      # Chargement des résultats INTRO
load("EKR-Champis-Naif-Light.RData")            # Chargement des résultats CLASSIFIEUR NAIF
load("EKR-Champis-AnalyseBi-Light.RData")       # Chargement des résultats CLASSIFICATION BINAIRE
load("EKR-Champis-AnalyseMultiFam-Light.RData")       # Chargement des résultats CLASSIF PAR FAMILLES
load("EKR-Champis-AnalyseMultiEsp-Light.RData")       # Chargement des résultats CLASSIF PAR ESPECES
load("EKR-Champis-CodeSourceBi-Light.RData")   # Chargement des données du code source (graphiques)
load("EKR-Generateur.RData")  # Chargement du générateur
load("EKR-DataSets.RData")  # Chargement des données des lots Schlimmer/Wagner
load("EKR-Champis-Outro.RData")    # Chargement des données de l'annexe statistique

library(ggpubr)   # Combiner graphes (ggarrange)
library(tidyverse)
```

# Introduction et objet de l'étude

## Objet de l'étude

-   "Application de modèles d'apprentissage machine à la classification des macromycètes"
    -   Apprentissage machine
    -   Classification
    -   Macromycètes

# Notion de macromycète

## Macromycètes

-   Macro-Mycète = "grand champignon"
-   Le champignon (*mycélium*) est en réalité quasi-invisible et intimement lié à son substrat
-   La partie visible du champignon est le *sporophore*

## Critère de forme

![](Photos/Formes/Craterellus_cornucopioides_2006_jg_1.jpg){fig-align="left" width="32%"} ![](Photos/Formes/Lycoperdon_perlatum_2010_mm_1.jpg){fig-align="center" width="32%"} ![](Photos/Formes/Morchella_esculenta_2007_ov_1.jpg){fig-align="right" width="32%"}

![](Photos/Formes/Pezziza%20spp_2007_go_1.jpg){fig-align="left" width="32%"} ![](Photos/Formes/Pleurotus_ostreatus_2007_ov_1.jpg){fig-align="center" width="32%"} ![](Photos/Formes/Tremella_mesenterica_2006_jg_1.jpg){fig-align="right" width="32%"}

![](Photos/Formes/Phallus_impudicus_2010_dg_1.jpg){.fragment .absolute bottom="40" left="360" height="540"}

::: footer
Source : MycoDB
:::

## Critère de couleur

![](Photos/Couleurs/Amanita_muscaria_2005_ov_2.jpg){fig-align="left" width="32%"} ![](Photos/Couleurs/Entoloma_euchroum_2021_fm_2+.jpg){fig-align="center" width="32%"} ![](Photos/Couleurs/Hygrocybe_psittacinus_2008_jd_1.jpg){fig-align="right" width="32%"}

![](Photos/Couleurs/Phellodon_niger_2013_jg_1.jpg){fig-align="left" width="32%"} ![](Photos/Couleurs/Laccaria_amethystina_1998_dr_1.jpg){fig-align="center" width="32%"} ![](Photos/Couleurs/Hygrocybe_psittacinus_2008_mp_1.jpg){fig-align="right" width="32%"}

::: footer
Source : MycoDB
:::

## Critère de texture

## Critère écologique

- Le champignon fait partie d'un écosystème
   - Hétérotrophie, interactions avec l'environnement
![](EcosystemeChampi.png)

## Caractéristiques du sporophore

![](AnatomieChampis.png)

# Notion de classification

## Classification

-   Classification binaire : oui/non
    -   Comestible ou non ?
    -   Définition *précise* du critère
-   Classification multiclasse : plusieurs catégories
    -   Familles
    -   Espèces
    -   Syndromes

## Notion de comestibilité

-   La comestibilité se situe sur un continuum :
    -   Excellents comestibles : *Tuber spp.*, *Amanita caesaria*...
    -   Comestibles : *Agaricus arvensis*...
    -   Comestibles cuits : *Morchella spp.*...
    -   Comestibles médiocres : *Boletus felleus*...
    -   Toxiques en grandes quantités : *Tricholoma equestre*...
    -   Toxiques : *Amanita muscaria*...
    -   Mortels : *Amanita phalloides*, *Amanita virosa*...

## Notion de comestibilité

| | C+ | C | CC | C- | T- | T | T+ |
|-|:--:|:-:|:--:|:--:|:--:|:-:|:--:|
| Prudent           | [✓]{style="color:green;"} | [✓]{style="color:green;"} | [✓]{style="color:green;"} |  [✗]{style="color:red;"}  |  [✗]{style="color:red;"}  | [✗]{style="color:red;"} | [✗]{style="color:red;"} |
| Gourmand          | [✓]{style="color:green;"} | [✓]{style="color:green;"} | [✓]{style="color:green;"} |  [✗]{style="color:red;"}  | [✓]{style="color:green;"} | [✗]{style="color:red;"} | [✗]{style="color:red;"} |
| Toxicologue | [✓]{style="color:green;"} | [✓]{style="color:green;"} |  [✗]{style="color:red;"}  | [✓]{style="color:green;"} |  [✗]{style="color:red;"}  | [✗]{style="color:red;"} | [✗]{style="color:red;"} |

-   Critères du "gastronome prudent"
    -   Toxiques et comestibles médiocres : à rejeter
    -   Comestibles cuits : à conserver (morilles !)

# Notion d'apprentissage machine

## Généralités


## Analyse Discriminante Linéaire


## Arbres de classification

## Forêts aléatoires

## Optimisation des modèles
- Indicateur de performance
   - Indice de Youden pondéré ($J_{w}$)
      - Indice synthétique pondérant spécificité et sensibilité
      - `r Jw_ratio`x plus grave d'accepter un non-comestible
   - Indice de Rand, Kappa
      - Reflet de la précision des prédictions (multiclasse)
- Exploration de l'espace des hyperparamètres
   - Plans d'expériences

## Plans hypercubiques latins

- Plan d'expérience occupant tout l'espace
   - 1 ligne + 1 colonne = 1 expérience

```{r, dev = "png", dev.args=list(bg="transparent"), fig.height = 3.5, fig.cap = "Carré latin aléatoire (à gauche), optimisé (au milieu), quasi-orthogonal (à droite)"}
plot(ggarrange(
   widths = c(1.05,1,1),
   ncol = 3,
   graphe_LHS + theme(
   panel.background = element_rect(fill = "transparent"),
   plot.background = element_rect(fill = "transparent"),
   legend.background = element_rect(fill="transparent"),
   legend.box.background = element_rect(fill="transparent")),
   graphe_optiLHS + theme(
   panel.background = element_rect(fill = "transparent"),
   plot.background = element_rect(fill = "transparent"),
   legend.background = element_rect(fill="transparent"),
   legend.box.background = element_rect(fill="transparent")),
   graphe_NOHLD + theme(
   panel.background = element_rect(fill = "transparent"),
   plot.background = element_rect(fill = "transparent"),
   legend.background = element_rect(fill="transparent"),
   legend.box.background = element_rect(fill="transparent"))
   )
)

```

# Génération du lot de données

## Construction du lot de données

- `r GEN_n_especes` espèces de champignons du Nord de la France
   - 25 critères caractéristiques
      - 22 critères qualitatifs
      - 3 critères quantitatifs
      - Espèce, famille, comestibilité
- `r GEN_n_champis` spécimens par espèce : `r BI_n_champis` champignons

- Tirage aléatoire des critères qualitatifs parmi les critères possibles pour chaque caractéristique et chaque espèce

## Génération des critères quantitatifs

- Critères dimensionnels :
   - Diamètre du chapeau $D_{c}$,
   - Diamètre du pied (stipe) $D_{S}$,
   - Hauteur du pied (stipe) $L_{S}$.
 - Proportionnels, liés à la croissance du champignon $F_{C}$.
$$\left \{
\begin{array}{l}
L_{S} = L_{S_{max}}.F_{C} \\
D_{S} = D_{S_{max}}.F_{C} \\
D_{C} = D_{C_{max}}.F_{C} \\
\end{array}
\right.$$

## Génération des critères quantitatifs : loi bêta
```{r, dev = "png", dev.args=list(bg="transparent")}
lois_beta + theme(
   panel.background = element_rect(fill = "transparent"),
   plot.background = element_rect(fill = "transparent"),
   legend.background = element_rect(fill="transparent"),
   legend.box.background = element_rect(fill="transparent")
)
```

## Induction de variabilité
- Champignons générés "parfaitement proportionnés"
- Nécessité d'induire des variations (dispersion $\delta~$)

$$\left \{
\begin{array}{ll} 
L_{S} = L_{Smax}.F_{T}.\delta_{Ls} & \delta_{Ls} \sim \mathcal{N}(\mu = 1 ; \sigma = 0.05) \\
D_{S} = D_{Smax}.F_{T}.\delta_{Ds} & \delta_{Ds} \sim \mathcal{N}(\mu = 1 ; \sigma = 0.05) \\
D_{C} = D_{Cmax}.F_{T}.\delta_{Dc} & \delta_{Dc} \sim \mathcal{N}(\mu = 1 ; \sigma = 0.05) \\
\end{array}
\right.$$

## Induction de variabilité

```{r}
nuage3D_sansdispersion
```

## Induction de variabilité

```{r}
nuage3D_avecdispersion
```

# Classification binaire

## Modèle naïf

## LDA

## Arbres décisionnels

## Forêts aléatoires

# Classification par familles

## LDA

## Arbres décisionnels

## Forêts aléatoires

# Classification par espèces

## Forêts aléatoires